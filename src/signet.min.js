var signet=function(){"use strict";function a(a,b,c,d){return a[b].reduce(function(a,b){return b(a,c,d)},b)}function b(a){return function(b){return a===typeof b}}function c(a){return function(b){return b instanceof a}}function d(a){return function(b){return null!==b.match(a)}}function e(a){return 0===a.length||a.filter(f).length>0}function f(a){var c=!b("function")(D[a.type]),d=b("string")(a.subType)&&"object"!==a.type;return c||d}function g(a,b){var c=1>=a,d="accept"===a.reduce(I,"init"),e=a[0].length>=b.length,f=e?"Invalid function signature; ensure all input and output paths are valid":"All function parameters are not accounted for in type definition";if(!e||c||!d)throw new Error(f)}function h(a,b,c){if(b===a)throw new TypeError(c)}function i(a){return d(/^\(\s*\)$/)(a)?a.replace(/\s*/g,""):a.replace(/[()]/g,"")}function j(a){return a.split(/\s*\=\>\s*/g)}function k(a,b,c){Object.defineProperty(a,b,{value:c,writeable:!1})}function l(a,b,c){return c.length>1&&(k(a,"signature",b),k(a,"signatureTree",c)),a}function m(a){var c=a.replace(/[\[\]]/g,"").split(/\s*(\<|\:)\s*/),e=c[0],f=c.length>1?c.pop().trim():void 0,g=b("string")(f)&&("array"===e||null!==a.match(/^[^\<]+\<[^\>]+\>$/));return{type:e,subType:g?void 0:f,valueType:g?f.substring(0,f.length-1).split(/\s*\;+\s*/g):void 0,optional:d(/\[[^\]]+\]/)(a)}}function n(a){return i(a.trim()).split(/\s*\,\s*/g).map(m)}function o(a){var c=a.type;return b("undefined")(a.valueType)||(c+="<"+a.valueType.join(";")+">"),c}function p(a,b){return"skip"===a?b:b.slice(1)}function q(a,b){return 0===a.length||0===b.length}function r(a,b,c){var d="Expected type "+o(a[0])+" but got "+typeof b[0],e=a.slice(1),f=p(c,b),g=q(e,f);return h("fail",c,d),g?c:s(e,f,c)}function s(a,c,d){var e=b("undefined")(d)?"accept":d,f=J(e,a[0],c[0]);return r(a,c,f)}function t(a,b){var c=a.length<=b.length;return c?b.join(","):t(a,b.concat(["x"+b.length]))}function u(a,b){var c=a.apply(null,b),d=j(a.signature).slice(1).join(" => "),e=a.signatureTree.slice(1);return l(c,d,e),e.length>1?y(c):c}function v(a){var b="return function enforceWrapper ("+t(a,[])+") {verify(signedFn, arguments);return callAndEnforce(signedFn, Array.prototype.slice.call(arguments));};",c=new Function(["signedFn","verify","callAndEnforce"],b);return c(a,x,u)}function w(a,b){var c=j(a).map(n);return g(c,b),l(b,a,c)}function x(a,b){var c=s(a.signatureTree[0],Array.prototype.slice.call(b,0));h("skip",c,"Optional types were not fulfilled properly")}function y(a){var b=v(a);return k(b,"signature",a.signature),k(b,"signatureTree",a.signatureTree),k(b,"toString",a.toString.bind(a)),b}function z(a,b){if("undefined"!=typeof D[a])throw new Error("Cannot redefine type "+a);D[a]=b}function A(a){var b=a+", object, function => boolean";return function(a,c){var d=K(b,c);z(a,d)}}function B(a,b){z(a,C(b))}function C(a){var b=m(a);return function(a){var c=!0;try{c=D[b.type](a,b)}catch(d){c=!1}return c}}var D={"()":b("string"),any:b("string"),array:c(Array),"boolean":b("boolean"),"function":b("function"),number:b("number"),object:b("object"),string:b("string"),symbol:b("symbol"),undefined:b("undefined")},E=[function(a,b){return 1===b.length?"accept":"init"},function(a,b){return e(b)?"fail":a}],F={init:E,accept:E,fail:[]},G=[function(a,b,c){return D[b.type](c,b,C)?"accept":"fail"},function(a,b){return b.optional&&"fail"===a?"skip":a}],H={skip:G,accept:G,fail:[]},I=a.bind(null,F),J=a.bind(null,H),K=function(a,b){return y(w(a,b))},L={alias:K("string, string => undefined",B),enforce:K("string, function => function",K),extend:K("string, function => undefined",z),isTypeOf:C,sign:K("string, function => function",w),subtype:K("string => string, function => undefined",A),verify:K("function, object => undefined",x)};return"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=L),L}();