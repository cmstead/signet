var signet=function(){"use strict";function a(a,b,c,d){return a[b].reduce(function(a,b){return b(a,c,d)},b)}function b(a){return function(b){return a===typeof b}}function c(a){return function(b){return b instanceof a}}function d(a){return function(b){return null!==b.match(a)}}function e(a){return 0===a.length||a.filter(f).length>0}function f(a){var c=!b("function")(y[a.type]),d=b("string")(a.subType)&&"object"!==a.type;return c||d}function g(a,b){var c=1>=a,d="accept"===a.reduce(D,"init"),e=a[0].length>=b.length,f=e?"Invalid function signature; ensure all input and output paths are valid":"All function parameters are not accounted for in type definition";if(!e||c||!d)throw new Error(f)}function h(a,b,c){if(b===a)throw new TypeError(c)}function i(a){return d(/^\(\s*\)$/)(a)?a.replace(/\s*/g,""):a.replace(/[()]/g,"")}function j(a){return a.split(/\s*\=\>\s*/g)}function k(a,b,c){Object.defineProperty(a,b,{value:c,writeable:!1})}function l(a,b,c){return c.length>1&&(k(a,"signature",b),k(a,"signatureTree",c)),a}function m(a){var c=a.replace(/[\[\]]/g,"").split(/\s*(\<|\:)\s*/),e=c[0],f=c.length>1?c.pop().replace(">"):void 0,g=b("string")(f)&&"array"===e;return{type:e,subType:g?void 0:f,valueType:g?f:void 0,optional:d(/\[[^\]]+\]/)(a)}}function n(a){return i(a.trim()).split(/\s*\,\s*/g).map(m)}function o(a,b){return"skip"===a?b:b.slice(1)}function p(a,b){return 0===a.length||0===b.length}function q(a,b,c){var d="Expected type "+a[0].type+" but got "+typeof b[0],e=a.slice(1),f=o(c,b),g=p(e,f);return h("fail",c,d),g?c:r(e,f,c)}function r(a,c,d){var e=b("undefined")(d)?"accept":d,f=E(e,a[0],c[0]);return q(a,c,f)}function s(a,b){var c=a.length<=b.length;return c?b.join(","):s(a,b.concat(["x"+b.length]))}function t(a,b){var c=a.apply(null,b),d=j(a.signature).slice(1).join(" => "),e=a.signatureTree.slice(1);return l(c,d,e),e.length>1?x(c):c}function u(a){var b="return function enforceWrapper ("+s(a,[])+") {verify(signedFn, arguments);return callAndEnforce(signedFn, Array.prototype.slice.call(arguments));};",c=new Function(["signedFn","verify","callAndEnforce"],b);return c(a,w,t)}function v(a,b){var c=j(a).map(n);return g(c,b),l(b,a,c)}function w(a,b){var c=r(a.signatureTree[0],Array.prototype.slice.call(b,0));h("skip",c,"Optional types were not fulfilled properly")}function x(a){var b=u(a);return k(b,"signature",a.signature),k(b,"signatureTree",a.signatureTree),k(b,"toString",a.toString.bind(a)),b}var y={"()":b("string"),any:b("string"),array:c(Array),"boolean":b("boolean"),"function":b("function"),number:b("number"),object:b("object"),string:b("string"),symbol:b("symbol"),undefined:b("undefined")},z=[function(a,b){return 1===b.length?"accept":"init"},function(a,b){return e(b)?"fail":a}],A={init:z,accept:z,fail:[]},B=[function(a,b,c){return y[b.type](c)?"accept":"fail"},function(a,b){return b.optional&&"fail"===a?"skip":a}],C={skip:B,accept:B,fail:[]},D=a.bind(null,A),E=a.bind(null,C),F=function(a,b){return x(v(a,b))},G={enforce:F("string, function => function",F),sign:F("string, function => function",v),verify:F("function, object => undefined",w)};return"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=G),G}();