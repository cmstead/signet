var signet=function(){"use strict";function a(a,b,c,d){for(var e=b,f=a[b],g=0;g<f.length;g++)e=f[g](e,c,d);return e}function b(a){return function(b){return a===typeof b}}function c(a){return function(b){return b instanceof a}}function d(a){return 0===a.length||a.filter(e).length>0}function e(a){var c=!b("function")(J[a.type]),d=b("string")(a.subType)&&"object"!==a.type;return c||d}function f(a,b){var c=1>=a,d="accept"===a.reduce(O,"init"),e=a[0].length>=b.length,f=e?"Invalid function signature; ensure all input and output paths are valid":"All function parameters are not accounted for in type definition";if(!e||c||!d)throw new Error(f)}function g(a,b,c){if(b===a)throw new TypeError(c)}function h(a){return a.split("=>")}function i(a,b,c){Object.defineProperty(a,b,{value:c,writeable:!1})}function j(a){return function(){return y(a)}}function k(a,b){return b.length>1&&(Object.defineProperty(a,"signature",{get:j(b),writeable:!1}),i(a,"signatureTree",b)),a}function l(a,b){var c=0===b&&"["===a[b],d=b===a.length-1&&"]"===a[b];return c||d}function m(a,b){return null!==a[b].match(/\s/)}function n(a){return function(b){for(var c=[],d="",e=0;e<b.length;e++){if(0===c.length&&b[e]===a){c.push(d),d=b.substring(e+1,b.length);break}l(b,e)||(d+=b[e])}return c.push(d),c}}function o(a,b){var c=n(b)(a);return"<"===b&&c[1]&&(c[1]=c[1].substring(0,c[1].length-1)),c}function p(a){for(var b=[],c=[],d="",e=0;e<a.length;e++)0===c.length&&";"===a[e]?(b.push(d),d=""):d+=a[e],"<"===a[e]?c.push("<"):">"===a[e]&&c.pop();return b.push(d),b}function q(a){var c=a.indexOf("object:")>-1?":":"<",d=o(a,c),e=d[0],f=d[1],g=b("string")(f)&&"<"===c;return{type:e,subType:g?void 0:f,valueType:g?p(f):void 0,optional:null!==a.match(/^\[.*\]$/)}}function r(a){for(var b=[],c="",d=0;d<a.length;d++)","===a[d]?(b.push(q(c)),c=""):m(a,d)||(c+=a[d]);return b.push(q(c)),b}function s(a){var c=a.type;return b("undefined")(a.valueType)||(c+="<"+a.valueType.join(";")+">"),c}function t(a,b){return"skip"===a?b:b.slice(1)}function u(a,b){return 0===a.length||0===b.length}function v(a,b,c){var d="Expected type "+s(a[0])+" but got "+typeof b[0],e=a.slice(1),f=t(c,b),h=u(e,f);return g("fail",c,d),h?c:w(e,f,c)}function w(a,c,d){var e=b("undefined")(d)?"accept":d,f=P(e,a[0],c[0]);return v(a,c,f)}function x(a,b){var c=a.length<=b.length;return c?b.join(","):x(a,b.concat(["x"+b.length]))}function y(a){var b,c,d,e="";for(c=0;c<a.length;c++)for(c>0&&(e+=" => "),d=0;d<a[c].length;d++)d>0&&(e+=", "),b=s(a[c][d]),a[c][d].optional&&(b="["+b+"]"),e+=b;return e}function z(a,b){if(!I(a)(b))throw new Error("Expected return value of type "+resultType+" but got "+typeof result)}function A(a,b){D(a,b);var c=a.apply(null,b),d=a.signatureTree.slice(1),e=d.length>1?"function":s(d[0][0]);return z(e,c),k(c,d),d.length>1?E(c):c}function B(a){var b="return function enforceWrapper ("+x(a,[])+") {return callAndEnforce(signedFn, Array.prototype.slice.call(arguments));};",c=new Function(["signedFn","callAndEnforce"],b);return c(a,A)}function C(a,b){var c=h(a).map(r);return f(c,b),k(b,c)}function D(a,b){var c=w(a.signatureTree[0],Array.prototype.slice.call(b,0));g("skip",c,"Optional types were not fulfilled properly")}function E(a){var b=B(a);return k(b,a.signatureTree),i(b,"toString",a.toString.bind(a)),b}function F(a,b){if("undefined"!=typeof J[a])throw new Error("Cannot redefine type "+a);J[a]=b}function G(a){var b=a+", object, function => boolean";return function(a,c){var d=Q(b,c);F(a,d)}}function H(a,b){F(a,I(b))}function I(a){var b=q(a);return function(a){var c=!0;try{c=J[b.type](a,b)}catch(d){c=!1}return c}}var J={"()":b("string"),any:function(){return!0},"*":function(){return!0},array:c(Array),"boolean":b("boolean"),"function":b("function"),number:b("number"),object:b("object"),string:b("string"),symbol:b("symbol"),undefined:b("undefined")},K=[function(a,b){return 1===b.length?"accept":"init"},function(a,b){return d(b)?"fail":a}],L={init:K,accept:K,fail:[]},M=[function(a,b,c){return J[b.type](c,b,I)?"accept":"fail"},function(a,b){return b.optional&&"fail"===a?"skip":a}],N={skip:M,accept:M,fail:[]},O=a.bind(null,L),P=a.bind(null,N),Q=function(a,b){return E(C(a,b))},R={alias:Q("string, string => undefined",H),enforce:Q("string, function => function",Q),extend:Q("string, function => undefined",F),isTypeOf:Q("string => * => boolean",I),sign:Q("string, function => function",C),subtype:Q("string => string, function => undefined",G),verify:Q("function, object => undefined",D)};return"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=R),R}();
!function(){"use strict";function a(a){return Math.floor(a)===a}function b(a,b){var c=parseInt(b.valueType[0],10),d=parseInt(b.valueType[1],10);return a>=c&&d>=a}function c(a,b){var c="bounded<"+b.valueType.join(";")+">";return i.isTypeOf(c)(a)}function d(a,b,c){return i.isTypeOf(b)(a[c])}function e(a,b){return a.length===b.valueType.length&&b.valueType.map(d.bind(null,a)).reduce(function(a,b){return a&&b},!0)}function f(a,b){var c=parseInt(b.valueType[0],10),d=b.valueType.length>1?parseInt(b.valueType[1],10):a.length;return c<=a.length&&a.length<=d}function g(a,b){var c=new RegExp(b.valueType.join(";"));return null!==a.match(c)}function h(a,b){return b.valueType.reduce(function(b,c){return b||i.isTypeOf(c)(a)},!1)}if("function"==typeof require)var i=require("./signet");i.subtype("number")("int",a),i.subtype("number")("bounded",b),i.subtype("int")("boundedInt",c),i.subtype("array")("tuple",e),i.subtype("string")("boundedString",f),i.subtype("string")("formattedString",g),i.extend("taggedUnion",h),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=i)}();