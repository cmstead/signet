var signet=function(){"use strict";function a(a,b,c,d){return a[b].reduce(function(a,b){return b(a,c,d)},b)}function b(a){return function(b){return a===typeof b}}function c(a){return function(b){return b instanceof a}}function d(a){return 0===a.length||a.filter(e).length>0}function e(a){var c=!b("function")(G[a.type]),d=b("string")(a.subType)&&"object"!==a.type;return c||d}function f(a,b){var c=1>=a,d="accept"===a.reduce(L,"init"),e=a[0].length>=b.length,f=e?"Invalid function signature; ensure all input and output paths are valid":"All function parameters are not accounted for in type definition";if(!e||c||!d)throw new Error(f)}function g(a,b,c){if(b===a)throw new TypeError(c)}function h(a){return a.split("=>")}function i(a,b,c){Object.defineProperty(a,b,{value:c,writeable:!1})}function j(a,b,c){return c.length>1&&(i(a,"signature",b),i(a,"signatureTree",c)),a}function k(a,b){var c=0===b&&"["===a[b],d=b===a.length-1&&"]"===a[b];return c||d}function l(a,b){return null!==a[b].match(/\s/)}function m(a){return function(b){for(var c=[],d="",e=0;e<b.length;e++){if(0===c.length&&b[e]===a){c.push(d),d=b.substring(e+1,b.length);break}k(b,e)||(d+=b[e])}return c.push(d),c}}function n(a,b){var c=m(b)(a);return"<"===b&&c[1]&&(c[1]=c[1].substring(0,c[1].length-1)),c}function o(a){for(var b=[],c=[],d="",e=0;e<a.length;e++)0===c.length&&";"===a[e]?(b.push(d),d=""):d+=a[e],"<"===a[e]?c.push("<"):">"===a[e]&&c.pop();return b.push(d),b}function p(a){var c=a.indexOf("object:")>-1?":":"<",d=n(a,c),e=d[0],f=d[1],g=b("string")(f)&&"<"===c;return{type:e,subType:g?void 0:f,valueType:g?o(f):void 0,optional:null!==a.match(/^\[.*\]$/)}}function q(a){for(var b=[],c="",d=0;d<a.length;d++)","===a[d]?(b.push(p(c)),c=""):l(a,d)||(c+=a[d]);return b.push(p(c)),b}function r(a){var c=a.type;return b("undefined")(a.valueType)||(c+="<"+a.valueType.join(";")+">"),c}function s(a,b){return"skip"===a?b:b.slice(1)}function t(a,b){return 0===a.length||0===b.length}function u(a,b,c){var d="Expected type "+r(a[0])+" but got "+typeof b[0],e=a.slice(1),f=s(c,b),h=t(e,f);return g("fail",c,d),h?c:v(e,f,c)}function v(a,c,d){var e=b("undefined")(d)?"accept":d,f=M(e,a[0],c[0]);return u(a,c,f)}function w(a,b){var c=a.length<=b.length;return c?b.join(","):w(a,b.concat(["x"+b.length]))}function x(a,b){var c=a.apply(null,b),d=h(a.signature).slice(1).join(" => "),e=a.signatureTree.slice(1);return j(c,d,e),e.length>1?B(c):c}function y(a){var b="return function enforceWrapper ("+w(a,[])+") {verify(signedFn, arguments);return callAndEnforce(signedFn, Array.prototype.slice.call(arguments));};",c=new Function(["signedFn","verify","callAndEnforce"],b);return c(a,A,x)}function z(a,b){var c=h(a).map(q);return f(c,b),j(b,a,c)}function A(a,b){var c=v(a.signatureTree[0],Array.prototype.slice.call(b,0));g("skip",c,"Optional types were not fulfilled properly")}function B(a){var b=y(a);return i(b,"signature",a.signature),i(b,"signatureTree",a.signatureTree),i(b,"toString",a.toString.bind(a)),b}function C(a,b){if("undefined"!=typeof G[a])throw new Error("Cannot redefine type "+a);G[a]=b}function D(a){var b=a+", object, function => boolean";return function(a,c){var d=N(b,c);C(a,d)}}function E(a,b){C(a,F(b))}function F(a){var b=p(a);return function(a){var c=!0;try{c=G[b.type](a,b)}catch(d){c=!1}return c}}var G={"()":b("string"),any:function(){return!0},"*":function(){return!0},array:c(Array),"boolean":b("boolean"),"function":b("function"),number:b("number"),object:b("object"),string:b("string"),symbol:b("symbol"),undefined:b("undefined")},H=[function(a,b){return 1===b.length?"accept":"init"},function(a,b){return d(b)?"fail":a}],I={init:H,accept:H,fail:[]},J=[function(a,b,c){return G[b.type](c,b,F)?"accept":"fail"},function(a,b){return b.optional&&"fail"===a?"skip":a}],K={skip:J,accept:J,fail:[]},L=a.bind(null,I),M=a.bind(null,K),N=function(a,b){return B(z(a,b))},O={alias:N("string, string => undefined",E),enforce:N("string, function => function",N),extend:N("string, function => undefined",C),isTypeOf:N("string => * => boolean",F),sign:N("string, function => function",z),subtype:N("string => string, function => undefined",D),verify:N("function, object => undefined",A)};return"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=O),O}();
!function(){"use strict";function a(a){return Math.floor(a)===a}function b(a,b){var c=parseInt(b.valueType[0],10),d=parseInt(b.valueType[1],10);return a>=c&&d>=a}function c(a,b){var c="bounded<"+b.valueType.join(";")+">";return i.isTypeOf(c)(a)}function d(a,b,c){return i.isTypeOf(b)(a[c])}function e(a,b){return a.length===b.valueType.length&&b.valueType.map(d.bind(null,a)).reduce(function(a,b){return a&&b},!0)}function f(a,b){var c=parseInt(b.valueType[0],10),d=b.valueType.length>1?parseInt(b.valueType[1],10):a.length;return c<=a.length&&a.length<=d}function g(a,b){var c=new RegExp(b.valueType.join(";"));return null!==a.match(c)}function h(a,b){return b.valueType.reduce(function(b,c){return b||i.isTypeOf(c)(a)},!1)}if("function"==typeof require)var i=require("./signet");i.subtype("number")("int",a),i.subtype("number")("bounded",b),i.subtype("int")("boundedInt",c),i.subtype("array")("tuple",e),i.subtype("string")("boundedString",f),i.subtype("string")("formattedString",g),i.extend("taggedUnion",h),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=i)}();